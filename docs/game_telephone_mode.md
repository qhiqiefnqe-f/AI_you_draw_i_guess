# 你画我猜 · 接龙模式（Draw & Guess: Telephone Mode）规则说明

本文档描述多人在线实时绘画与文字接龙的完整规则、阶段流程与房间参数，以娱乐、创意与展示为主，不设胜负判定。

## 一、游戏目标
- 通过绘画与描述轮流传递，所有玩家共同完成多条“传话链”。
- 展示阶段按链依次播放，从最初题目到最终结果，呈现“变形过程”。

## 二、参与规则
- 玩家人数：最少 3 人，推荐 6–10 人，上限 12 人。
- 开始前所有玩家须准备就绪。
- 每轮每位玩家都会收到上一个玩家的“输入”：可能是文字（题目）或图片（画作）。

## 三、阶段流程
### 1) 题目选择（仅第一轮）
- 每位玩家从房主配置的题库中随机获得 3 条题目，选择其一作为该玩家所发起的传话链的起点。
- 系统抽题（默认），也可配置房主自定义或混合词库。

### 2) 绘画阶段
- 任务：根据文字内容绘制图像。
- 限时：60/120/180 秒（房主配置，默认 60）。
- 工具：画笔、橡皮、调色板、撤销、清空。
- 可提前提交；超时自动提交当前画板内容。

### 3) 描述阶段
- 任务：根据上一位玩家的画猜测题目并输入文本，传递给下一位玩家。
- 限时：60/120 秒（房主配置，默认 60）。
- 未提交则记为“空白”。

### 4) 展示阶段（Result）
- 所有传话链完成后统一展示，顺序对所有人一致。
- 每条链依次展示：左上角常显原始题目 → 画布中间播放第一张画过程（可逐帧或动画）→ 第一次描述及描述的玩家（显示在第一张画下方）→清空画布→左上角显示第一次描述 画布中间播放第二张画过程 → …… → 最终答案（显示在最后一张画下方）→所有人画布中央弹出选择框→所有人可以评价其是否符合题目（投票是/否），选择框中间用✅或❌显示所有人的选择状态。


## 四、回合交替与传递规则
- 全局同步：所有玩家在当前阶段全部提交，或计时结束，才进入下一阶段。
- 传递示例（4 人 A/B/C/D）：
  - 第 1 轮：A 选题并画图（同时 B/C/D 分别选题并画图）
  - 第 2 轮：B 根据 A 的图描述；C 根据 B 的图描述；D 根据 C 的图描述；A 根据 D 的图描述（环形传递）
  - 第 3 轮：C 根据 B 的描述画图；…… 以此类推，最终以描述结尾。

## 五、关键一致性约束
- “传话链一定以描述（文本）结尾”。为满足该约束：
  - 若玩家数 N 为偶数：每名玩家对每条链恰好参与一次（除发起者的题目文本外），最后一步自然为描述。
  - 若 N 为奇数：每条链在本局中参与人数为 N-1（即有人在某条链上当轮轮空），使链的最后一步为描述；或选择在最后一步让发起者补充描述（同一玩家在一条链中出现两次），二选一以房主配置为准。

## 六、房间参数（可配置）
1. 玩家人数：最少 3，最多 12。
2. 绘画时间：60/120/180 秒；描述时间：60/120 秒。
3. 回合总数：与参与人数相匹配（见上“关键一致性约束”）。
4. 模式：接龙模式。
5. 初始题目：系统抽题（默认）；可关闭自定义初始题目。
6. 词库：内置/自定义/混合（房主选择）。

## 七、系统逻辑（后端实现参考）
- players[]：玩家列表（含顺序、状态、分配索引）。
- chains[]：传话链数组。每条链包含步骤序列：`prompt(text)` → `draw(image)` → `desc(text)` → … → `desc(text)`。
- roundIndex：当前全局回合索引（阶段推进）。
- stepType：当前阶段类型（draw 或 desc；题目选择阶段为 prompt）。
- timeout：阶段限时。
- submissions：玩家提交记录（文本或图片）。
- 流程：
  1) 所有人提交 → 检查状态；
  2) 若全提交或超时 → 推进到下一阶段；
  3) 最后一阶段后 → 进入展示阶段。

## 八、展示与保存
- 展示支持逐帧播放（根据笔画事件重放）或自动动画播放。
- 保存：每个绘画步骤保存位图快照（PNG/JPEG）用于下游描述；同时可保存笔画事件以便结果播放。

## 九、超时与缺失
- 绘画：超时自动提交当前画板快照。
- 描述：未提交则记为空白文本，链继续传递。
- 断线重连：重新下发当前阶段任务与必要的历史数据，玩家可继续参与。

## 十、补充说明与边界
- 环形传递：每一阶段所有链同时向下一位玩家轮转。分配算法需保证同一玩家在一阶段不会收到多条链冲突（一般每阶段每人处理一条链）。
- 内容安全与友好：可配置屏蔽敏感词；聊天与描述文本限频。
- 旁观与迟到：开始后不允许新玩家加入参与，可开放只读“观众模式”（可选）。

以上规则为后续设计与实现的基础。如需调整（例如奇数人数的结尾策略、是否允许发起者在同链参与两次以保证结尾为描述等），可在房主参数中明确选择。